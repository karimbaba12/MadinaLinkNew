<mat-stepper #stepper linear>
    <!-- Step 1: Tenant Creation -->
    <mat-step [stepControl]="tenantForm" label="Create Tenant">
        <form [formGroup]="tenantForm">
            <ng-template matStepLabel>Create Your Tenant</ng-template>

            <mat-form-field>
                <mat-label>Tenant Name</mat-label>
                <input matInput formControlName="tenantName" required>
                <mat-error *ngIf="tenantForm.get('tenantName')?.hasError('required')">
                    Tenant name is required
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <mat-label>Address</mat-label>
                <input matInput formControlName="address" required>
                <mat-error *ngIf="tenantForm.get('address')?.hasError('required')">
                    Address is required
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <mat-label>Phone Number</mat-label>
                <input matInput formControlName="phoneNumber" required>
                <mat-error *ngIf="tenantForm.get('phoneNumber')?.hasError('required')">
                    Phone number is required
                </mat-error>
                <mat-error *ngIf="tenantForm.get('phoneNumber')?.hasError('pattern')">
                    Please enter a valid phone number
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <mat-label>Email</mat-label>
                <input matInput formControlName="email" required>
                <mat-error *ngIf="tenantForm.get('email')?.hasError('required')">
                    Email is required
                </mat-error>
                <mat-error *ngIf="tenantForm.get('email')?.hasError('email')">
                    Please enter a valid email
                </mat-error>
            </mat-form-field>

            <div>
                <button mat-button matStepperNext [disabled]="tenantForm.invalid">Next</button>
            </div>
        </form>
    </mat-step>

    <!-- Step 2: Admin Creation -->
    <mat-step [stepControl]="adminForm" label="Create Admin">
        <form [formGroup]="adminForm">
            <ng-template matStepLabel>Create Admin Account</ng-template>

            <h3>Admin Account Details</h3>

            <mat-form-field>
                <mat-label>Full Name</mat-label>
                <input matInput formControlName="name" required>
                <mat-error *ngIf="adminForm.get('name')?.hasError('required')">
                    Name is required
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <mat-label>Username</mat-label>
                <input matInput formControlName="username" required>
                <mat-error *ngIf="adminForm.get('username')?.hasError('required')">
                    Username is required
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <mat-label>Email</mat-label>
                <input matInput formControlName="email" required>
                <mat-error *ngIf="adminForm.get('email')?.hasError('required')">
                    Email is required
                </mat-error>
                <mat-error *ngIf="adminForm.get('email')?.hasError('email')">
                    Please enter a valid email
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <mat-label>Phone Number</mat-label>
                <input matInput formControlName="phoneNumber">
                <mat-error *ngIf="adminForm.get('phoneNumber')?.hasError('pattern')">
                    Please enter a valid phone number
                </mat-error>
            </mat-form-field>

            <mat-form-field>
                <mat-label>Password</mat-label>
                <input matInput [type]="hidePassword ? 'password' : 'text'" formControlName="passwordHash" required>
                <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword">
                    <mat-icon>{{hidePassword ? 'visibility_off' : 'visibility'}}</mat-icon>
                </button>
                <mat-error *ngIf="adminForm.get('passwordHash')?.hasError('required')">
                    Password is required
                </mat-error>
                <mat-error *ngIf="adminForm.get('passwordHash')?.hasError('minlength')">
                    Password must be at least 8 characters
                </mat-error>
                <mat-error *ngIf="adminForm.get('passwordHash')?.hasError('pattern')">
                    Password must contain at least one uppercase, one lowercase, one number and one special character
                </mat-error>
            </mat-form-field>

            <h3>Admin Address (Optional)</h3>

            <div class="address-fields">
                <mat-form-field>
                    <mat-label>Country</mat-label>
                    <input matInput formControlName="country">
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Street</mat-label>
                    <input matInput formControlName="street">
                </mat-form-field>

                <mat-form-field>
                    <mat-label>City</mat-label>
                    <input matInput formControlName="city">
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Region</mat-label>
                    <input matInput formControlName="region">
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Governorates</mat-label>
                    <input matInput formControlName="governorates">
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Building</mat-label>
                    <input matInput formControlName="building">
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Floor</mat-label>
                    <input matInput type="number" formControlName="floor">
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Direction</mat-label>
                    <input matInput formControlName="direction">
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Block</mat-label>
                    <input matInput formControlName="block">
                </mat-form-field>
            </div>

            <div>
                <button mat-button matStepperPrevious>Back</button>
                <button mat-button matStepperNext [disabled]="adminForm.invalid">Next</button>
            </div>
        </form>
    </mat-step>

    <!-- Step 3: Review and Submit -->
    <mat-step label="Review and Submit">
        <ng-template matStepLabel>Review and Submit</ng-template>

        <h2>Review Your Information</h2>

        <div class="review-section">
            <h3>Tenant Details</h3>
            <p><strong>Name:</strong> {{tenantForm.value.tenantName}}</p>
            <p><strong>Address:</strong> {{tenantForm.value.address}}</p>
            <p><strong>Phone:</strong> {{tenantForm.value.phoneNumber}}</p>
            <p><strong>Email:</strong> {{tenantForm.value.email}}</p>
        </div>

        <div class="review-section">
            <h3>Admin Details</h3>
            <p><strong>Name:</strong> {{adminForm.value.name}}</p>
            <p><strong>Username:</strong> {{adminForm.value.username}}</p>
            <p><strong>Email:</strong> {{adminForm.value.email}}</p>
            <p><strong>Phone:</strong> {{adminForm.value.phoneNumber || 'Not provided'}}</p>
        </div>

        <div>
            <button mat-button matStepperPrevious>Back</button>
            <button mat-button (click)="submit()">Submit</button>
        </div>
    </mat-step>
</mat-stepper>